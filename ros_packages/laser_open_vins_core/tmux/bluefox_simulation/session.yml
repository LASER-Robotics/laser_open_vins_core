root: ./
name: simulation
startup_window: open_vins
pre_window: export UAV_NAME=uav1; export REAL_UAV=false; export UAV_SENSORS="--enable_livox --enable_ground_truth"
windows:
  - gazebo:
      layout: tiled
      panes:
        - ros2 launch laser_uav_simulation gazebo.launch.py world:=forest
  - spawn:
      layout: even-horizontal
      panes:
        - ~/git/laser_uav_system/ros_packages/laser_uav_simulation/scripts/spawn_drone.sh 0.0 0.0 0.2 0.0 3
        - ~/git/laser_uav_system/ros_packages/laser_uav_simulation/scripts/start_uxrce_protocol.sh
  - px4_api:
      layout: tiled
      panes:
        - sleep 1; ros2 launch laser_uav_px4_api api.launch.py
  - control_manager:
      layout: tiled
      panes:
        - sleep 1; ros2 launch laser_uav_managers control_manager.launch.py
        - 'history -s ros2 service call /$UAV_NAME/px4_api/arm std_srvs/srv/Trigger {}'
        - 'history -s ros2 service call /$UAV_NAME/control_manager/takeoff std_srvs/srv/Trigger {}'
        - 'history -s ros2 service call /$UAV_NAME/control_manager/land std_srvs/srv/Trigger {}'
  # - open_vins:
  #     layout: tiled
  #     panes:
  #       - ros2 launch laser_open_vins_core vio_simulation.launch.py
  # - vins_republisher:
  #     layout: tiled
  #     panes:
  #       - ros2 launch laser_vins_republisher vins_republisher.launch.py
  # - odometry:
  #     layout: even-horizontal
  #     panes:
  #       - sleep 10; ros2 topic echo --no-arr /$UAV_NAME/ground_truth
  #       - sleep 10; ros2 topic echo --no-arr /$UAV_NAME/vins_republisher/odometry
  - goto:
      layout: tiled
      panes:
        - 'history -s ros2 topic pub -1 /$UAV_NAME/control_manager/goto geometry_msgs/msg/Pose \"{position: {x: 0.0, y: 10.0, z: 1.5}, orientation: {x: 0.0, y: 0.0, z: 0.0, w: 1.0}}\"'
  # - rviz:
  #     layout: tiled
  #     panes:
  #       - sleep 10; ros2 launch laser_open_vins_core rviz.launch.py
